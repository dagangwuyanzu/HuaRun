<!-- <!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./css/base.css">
    <link rel="stylesheet" href="./css/hero.css">
    <title>Document</title>
</head>

<body>
    <div class="nav">
        <ul class="ul1">
            <li>
                <a href="LOL_index.html">
                    <img src="../html/img/LOL-nav.png" alt="">
                </a>
            </li>
            <li>
                <a href="#">
                    <span>游戏资料</span>
                    <span>GAME INFO</span>
                </a>
            </li>
            <li>
                <a href="shopping.html">
                    <span>商城/合作</span>
                    <span>STORE</span>
                </a>
            </li>
            <li>
                <a href="#">
                    <span>社区活动</span>
                    <span>COMMUNITY</span>
                </a>
            </li>
            <li>
                <a href="#">
                    <span>赛事官网</span>
                    <span>ESPORTS</span>
                </a>
            </li>
            <li>
                <a href="#">
                    <span>自助系统</span>
                    <span>SYSTEM</span>
                </a>
            </li>
        </ul>
        <ul class="ul2">
            <li>
                <a href="#">
                    <img src="../html/img/LOL-nav-sousuo.png" alt="">
                </a>
            </li>
            <li>
                <a href="#">
                    <img src="../html/img/LOL-nav-shouji.png" alt="">
                </a>
            </li>
            <li>
                <a href="login.html">
                    <img src="../html/img/LOL-nav-wode.png" alt="">
                    <span>亲爱的召唤师，欢迎<span class="dl">登录</span></span>
                </a>
            </li>
        </ul>
    </div>
    <div class="car">
        <a href="car.html">
            <span>购物车</span>
            ( <span class="qty">0</span> )
        </a>
    </div>

    <div class="res">

    </div>
    <script src="./lib/jquery3.5.1.js"></script>
    <script src="./utils/utils.js"></script>
    <script>
        var cartlist = localStorage.getItem('cartlist');
        try {
            cartlist = JSON.parse(cartlist) || [];
        } catch (err) {
            cartlist = [];
        }
        jQuery(($) => {
            $('.qty').html(cartlist.length)
        });
        let res = document.querySelector('.res');
        let params = location.search.slice(1).split('&');
        let data = {};
        params.forEach(item => {
            let arr = item.split('=');
            data[arr[0]] = arr[1];
        });
        let goodsData = {};
        request({
            url: '/hero.php',
            data: {
                id: data.id
            },
            success({
                    data
                }

            ) {
                console.log('data=', data);
                goodsData = data;
                res.innerHTML =
                    `<dl data-id="${data.id}"><dt><a href="#"><img src="${data.imgurl}"></a></dt><dd><a href="#" class="aname">${data.name}</a><div class="Qprice"><span>Q币价：</span><span>${data.Qprice}</span><span>Q币</span></div><div class="Wprice"><span>微信价：</span><span>￥${data.Wprice}</span></div><button style="margin:15px 17px; " class="btn btn1">加入购物车</button><button class="btn btn2">立即购买</button></dd></dl>`
            }
        })






        // 点击
        res.onclick = function (e) {
            // 点击加入购物车
            if (e.target.classList.contains('btn1')) {
                // let _goodsData = goodsData.find(item => item.id === e.target.parentElement.parentElement.dataset
                //     .id);
                console.log('cartlist=', cartlist)
                console.log('goodsData=', goodsData);
                let currentGoods = cartlist.find(item => item.id === goodsData.id);
                if (currentGoods) {
                    currentGoods.qty++;
                } else {
                    goodsData.qty = 1;
                    cartlist.unshift(goodsData);
                }
                $('.qty').html(cartlist.length);
                localStorage.setItem('cartlist', JSON.stringify(cartlist));

                // 点击跳转立即购买
            } else if (e.target.classList.contains('btn2')) {
                let currentGoods = cartlist.find(item => item.id === goodsData.id);
                if (currentGoods) {
                    currentGoods.qty++;
                } else {
                    goodsData.qty = 1;
                    cartlist.unshift(goodsData);
                }
                // 实时更新购物车数量
                $('.qty').html(cartlist.length);
                localStorage.setItem('cartlist', JSON.stringify(cartlist));
                location.href = 'car.html'
            }
        };
    </script>
</body>

</html> -->